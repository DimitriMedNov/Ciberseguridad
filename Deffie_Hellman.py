from Crypto.Hash import SHA256
import hashlib
import random

g = 2
p = 2410312426921032588552076022197566074856950548502459942654116941958108831682612228890093858261341614673227141477904012196503648957050582631942730706805009223062734745341073406696246014589361659774041027169249453200378729434170325843778659198143763193776859869524088940195577346119843545301547043747207749969763750084308926339295559968882457872412993810129130294592999947926365264059284647209730384947211681434464714438488520940127459844288859336526896320919633919

# CÃ¡lculo de las claves privadas
alice = random.getrandbits(256)
bob = random.getrandbits(256)

# Paso 3: Calcular A y B
A = pow(g, alice, p)
B = pow(g, bob, p)

print("Alice: ", A)
print("Bob: ", B)

# Paso 4: Calcular las llaves secretas y verificar con SHA-256
s1 = pow(B, alice, p)
s2 = pow(A, bob, p)

# Usar SHA-256 para verificar

if s1 == s2:
    s = hashlib.sha256(str(s1).encode()).hexdigest()
    print("Llave secreta: ", s)
else:
    print("Las llaves secretas no coinciden")





